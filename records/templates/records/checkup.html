{% extends 'base.html' %}
{% block main %}
  <div class="flex justify-between items-center mb-6 p-4 rounded-lg">
    <h1 class="text-2xl font-bold">Checkup List</h1>
    <form action="" method="GET" class="flex items-center max-w-lg w-full">
      <input type="text" placeholder="Search for patients or check up details" name="search" class="w-full px-4 py-2 border rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" />
    </form>
    <a href="{% url 'add-patient' %}"><button class="bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md">New Checkup</button></a>
  </div>

  <div class="overflow-x-auto">
    <table class="min-w-full bg-white border border-gray-200 divide-y divide-gray-200">
      <thead>
        <tr>
          <th class="px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-center align-middle">Patient Name</th>
          <th class="px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-center align-middle">Check Up Detail</th>
          <th class="px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-center align-middle">Added</th>
          <th class="px-6 py-3 text-xs font-medium text-gray-500 uppercase tracking-wider text-center align-middle">Actions</th>
        </tr>
      </thead>
      <tbody>
        {% if items %}
          {% for item in items %}
            <tr class="even:bg-gray-50">
              <td class="px-6 py-4 whitespace-nowrap text-center align-middle">{{ item.patient.first_name }} {{ item.patient.last_name }}</td>
              <td class="px-6 py-4 whitespace-nowrap text-center align-middle">{{ item.checkup_details|truncatechars:'20' }}</td>
              <td class="px-6 py-4 whitespace-nowrap text-center align-middle">{{ item.date_added }}</td>

              <td class="px-6 py-4 whitespace-nowrap text-center align-middle space-x-2">
                <a href="{% url 'update_checkup' item.id %}" class="inline-block bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded transition duration-300"><i class="fas fa-edit mr-2"></i>Edit</a>
                {% comment %} <a href="#" class="inline-block bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded transition duration-300"><i class="fas fa-trash-alt mr-2"></i>Delete</a> {% endcomment %}
                {% comment %} <a href="#" class="inline-block bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded transition duration-300"><i class="fas fa-eye mr-2"></i>View</a> {% endcomment %}
                {% if item.request_set.all %}
                  {% for request in item.request_set.all %}
                    <a href="{% url 'request' request.id %}" class="inline-block bg-orange-500 hover:bg-orange-700 text-white font-bold py-2 px-4 rounded transition duration-300"><i class="fas fa-eye mr-2"></i>View Medicine Request</a>
                  {% endfor %}
                {% endif %}
              </td>
            </tr>
          {% endfor %}
        {% else %}
          <tr>
            <td colspan="7" class="px-6 py-4 whitespace-nowrap text-center align-middle">No data fetched.</td>
          </tr>
        {% endif %}
      </tbody>
    </table>
    {% if items %}
      {% include 'paginate.html' %}
    {% endif %}
  </div>
{% endblock %}
